{% extends "base.html" %} {% block content %}
<div class="row">
  <div class="col-lg-8">
    <div class="card">
      <div class="card-header">
        <h3>üìù Report Incident</h3>
      </div>
      <div class="card-body">
        <form method="POST" enctype="multipart/form-data" id="reportForm">
          <div class="mb-3">
            <label for="title" class="form-label">Incident Title *</label>
            <input
              type="text"
              class="form-control"
              name="title"
              required
              placeholder="Brief description of the incident"
            />
          </div>

          <div class="mb-3">
            <label for="description" class="form-label">Description *</label>
            <textarea
              class="form-control"
              name="description"
              rows="4"
              required
              placeholder="Provide detailed information about what happened..."
            ></textarea>
          </div>

          <div class="mb-3">
            <label for="image" class="form-label">Photo Evidence</label>
            <input
              type="file"
              class="form-control"
              name="image"
              accept="image/*"
            />
            <div class="form-text">
              Optional: Upload an image (PNG, JPG, JPEG, GIF)
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <label for="latitude" class="form-label">Latitude</label>
              <input
                type="number"
                step="any"
                class="form-control"
                name="latitude"
                id="latitude"
                readonly
              />
            </div>
            <div class="col-md-6">
              <label for="longitude" class="form-label">Longitude</label>
              <input
                type="number"
                step="any"
                class="form-control"
                name="longitude"
                id="longitude"
                readonly
              />
            </div>
          </div>

          <div class="mb-3 mt-2">
            <button type="button" class="btn btn-outline-info" id="getLocation">
              üìç Get My Location
            </button>
            <span id="locationStatus" class="ms-2 text-muted"></span>
          </div>

          <div class="alert alert-warning">
            <strong>‚ö° Auto-Classification:</strong> Your report will be
            automatically analyzed for urgency based on keywords. Emergency
            keywords will trigger urgent classification.
          </div>

          <button type="submit" class="btn btn-primary">Submit Report</button>
          <a href="{{ url_for('dashboard') }}" class="btn btn-secondary"
            >Cancel</a
          >
        </form>
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <div class="card">
      <div class="card-header">
        <h5>üìã Reporting Tips</h5>
      </div>
      <div class="card-body">
        <ul class="list-unstyled">
          <li>
            <strong>üö® For immediate emergencies:</strong> Call emergency
            services first!
          </li>
          <li>
            <strong>üìç Location:</strong> Enable location sharing for faster
            response
          </li>
          <li>
            <strong>üì∏ Photos:</strong> Include clear images when safe to do so
          </li>
          <li>
            <strong>‚úèÔ∏è Description:</strong> Be specific about what you observed
          </li>
        </ul>

        <h6 class="mt-3">üî• Urgent Keywords:</h6>
        <small class="text-muted">
          Emergency, fire, flood, earthquake, explosion, accident, injured,
          trapped, immediate help needed
        </small>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script>
  document.getElementById("getLocation").addEventListener("click", function () {
    const statusSpan = document.getElementById("locationStatus");
    const latInput = document.getElementById("latitude");
    const lngInput = document.getElementById("longitude");

    if (navigator.geolocation) {
      statusSpan.textContent = "Getting location...";
      statusSpan.className = "ms-2 text-info";

      navigator.geolocation.getCurrentPosition(
        function (position) {
          latInput.value = position.coords.latitude.toFixed(6);
          lngInput.value = position.coords.longitude.toFixed(6);
          statusSpan.textContent = "‚úÖ Location obtained";
          statusSpan.className = "ms-2 text-success";
        },
        function (error) {
          statusSpan.textContent = "‚ùå Location access denied";
          statusSpan.className = "ms-2 text-danger";
        }
      );
    } else {
      statusSpan.textContent = "‚ùå Geolocation not supported";
      statusSpan.className = "ms-2 text-danger";
    }
  });
</script>
{% endblock %}
